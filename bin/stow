#!/bin/sh

if [ "$(uname)" = "Darwin" -o "$(uname)" = "FreeBSD" ]; then
    STOWBIN=/usr/local/bin/stow
    READLINK=/usr/local/bin/greadlink
else
    STOWBIN=/usr/bin/stow
    READLINK=/bin/readlink
fi

if [ $1 ]
then
    TARGET_DIR=$1
else
    TARGET_DIR=$($READLINK -f $HOME)
fi

echo $TARGET_DIR

$STOWBIN \
    -t $TARGET_DIR/ \
    -d $( builtin cd $(dirname $0)/../ ; pwd -P ) \
    --ignore='.gitmodules' \
    --ignore='.git' \
    --ignore='LICENSE' \
    --ignore='README.md' \
    --ignore='TODO' \
    --ignore='bin' \
    dotfiles

